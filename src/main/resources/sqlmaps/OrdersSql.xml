<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sqlmaps.OrdersSql">
	<select id="selectOrders" parameterType="java.util.HashMap" resultType="com.hunasys.labelsketch.orders.vo.OrdersVo">
		SELECT
			  ORDER_ID                                      as "orderId"
			, ITEM_CLS                                      as "itemCls"
			, COMPANY                                       as "company"
			, ITEM_NM                                       as "itemNm"
			, ITEM_SPEC                                     as "itemSpec"
			, TOTAL_QTY                                     as "totalQty"
			, PAPER1                                        as "paper1"
			, PAPER2                                        as "paper2"
			, PAPER3                                        as "paper3"
			, PAPER4                                        as "paper4"
			, PARER_ROLL                                    as "parerRoll"
			, ROLL_QTY                                      as "rollQty"
			, DUE_DATE                                      as "dueDate"
			, DELIVERY                                      as "delivery"
			, DESCRIPTION                                   as "description"
			, FILE1                                         as "file1"
			, FILE2                                         as "file2"
			, USER_ID                                       as "userId"
			, date_format(NEW_DATETIME,'%Y-%m-%d') as "newDate"
			, date_format(NEW_DATETIME,'%H:%i:%S') as "newTime"
			, date_format(MOD_DATETIME,'%Y-%m-%d') as "modDate"
			, date_format(MOD_DATETIME,'%H:%i:%S') as "modTime"
			, date_format(END_DATETIME,'%Y-%m-%d') as "endDate"
			, date_format(END_DATETIME,'%H:%i:%S') as "endTime"
		FROM
			ORDERS

		ORDER BY NEW_DATETIME DESC
		LIMIT 10 OFFSET 0
	</select>

	<select id="selectOrder" parameterType="long" resultType="com.hunasys.labelsketch.orders.vo.OrdersVo">
		SELECT
			  ORDER_ID                                      as "orderId"
			, ITEM_CLS                                      as "itemCls"
			, COMPANY                                       as "company"
			, ITEM_NM                                       as "itemNm"
			, ITEM_SPEC                                     as "itemSpec"
			, TOTAL_QTY                                     as "totalQty"
			, PAPER1                                        as "paper1"
			, PAPER2                                        as "paper2"
			, PAPER3                                        as "paper3"
			, PAPER4                                        as "paper4"
			, PARER_ROLL                                    as "parerRoll"
			, ROLL_QTY                                      as "rollQty"
			, DUE_DATE                                      as "dueDate"
			, DELIVERY                                      as "delivery"
			, DESCRIPTION                                   as "description"
			, FILE1                                         as "file1"
			, FILE2                                         as "file2"
			, USER_ID                                       as "userId"
			, date_format(NEW_DATETIME,'%Y-%m-%d') as "newDate"
			, date_format(NEW_DATETIME,'%H:%i:%S') as "newTime"
			, date_format(MOD_DATETIME,'%Y-%m-%d') as "modDate"
			, date_format(MOD_DATETIME,'%H:%i:%S') as "modTime"
			, date_format(END_DATETIME,'%Y-%m-%d') as "endDate"
			, date_format(END_DATETIME,'%H:%i:%S') as "endTime"
		FROM
			ORDERS
		<where>
			AND ORDER_ID = #{orderId}
		</where>
	</select>

	<insert 
		id="insertOrder" 
		parameterType="com.hunasys.labelsketch.orders.vo.OrdersVo" 
		useGeneratedKeys="true"
		keyProperty="orderId">
		/* 주문 입력 */
		INSERT INTO
			ORDERS
			(
				  ITEM_CLS   
				, COMPANY    
				, ITEM_NM    
				, ITEM_SPEC  
				, TOTAL_QTY  
				, PAPER1     
				, PAPER2     
				, PAPER3     
				, PAPER4     
				, PARER_ROLL 
				, ROLL_QTY   
				, DUE_DATE   
				, DELIVERY   
				, DESCRIPTION
				, FILE1      
				, FILE2      
				, USER_ID    
				, NEW_DATETIME
			)
		VALUES 
			(
				  #{itemCls,jdbcType=VARCHAR}
				, #{company,jdbcType=VARCHAR}
				, #{itemNm,jdbcType=VARCHAR}
				, #{itemSpec,jdbcType=VARCHAR}
				, #{totalQty,jdbcType=INTEGER}
				, #{paper1,jdbcType=VARCHAR}
				, #{paper2,jdbcType=VARCHAR}
				, #{paper3,jdbcType=VARCHAR}
				, #{paper4,jdbcType=VARCHAR}
				, #{parerRoll,jdbcType=VARCHAR}
				, #{rollQty,jdbcType=INTEGER}
				, #{dueDate,jdbcType=VARCHAR}
				, #{delivery,jdbcType=VARCHAR}
				, #{description,jdbcType=VARCHAR}
				, #{file1,jdbcType=BIGINT}
				, #{file2,jdbcType=BIGINT}
				, #{userId,jdbcType=VARCHAR}
				, now()
			)   
	</insert>

	<update id="updateOrder" parameterType="com.hunasys.labelsketch.orders.vo.OrdersVo">
		/* 주문 수정 */
		UPDATE
			ORDERS
		<set>
			<if test="itemCls     != null">  ITEM_CLS      = #{itemCls}      , </if>
			<if test="company     != null">  COMPANY       = #{company}      , </if>
			<if test="itemNm      != null">  ITEM_NM       = #{itemNm}       , </if>
			<if test="itemSpec    != null">  ITEM_SPEC     = #{itemSpec}     , </if>
			<if test="totalQty    != null">  TOTAL_QTY     = #{totalQty}     , </if>
			<if test="paper1      != null">  PAPER1        = #{paper1}       , </if>
			<if test="paper2      != null">  PAPER2        = #{paper2}       , </if>
			<if test="paper3      != null">  PAPER3        = #{paper3}       , </if>
			<if test="paper4      != null">  PAPER4        = #{paper4}       , </if>
			<if test="parerRoll   != null">  PARER_ROLL    = #{parerRoll}    , </if>
			<if test="rollQty     != null">  ROLL_QTY      = #{rollQty}      , </if>
			<if test="dueDate     != null">  DUE_DATE      = #{dueDate}      , </if>
			<if test="delivery    != null">  DELIVERY      = #{delivery}     , </if>
			<if test="description != null">  DESCRIPTION   = #{description}  , </if>
			<if test="file1       != null">  FILE1         = #{file1}        , </if>
			<if test="file2       != null">  FILE2         = #{file2}        , </if>
			<if test="userId      != null">  USER_ID       = #{userId}       , </if>
			<if test="setEnd      != null">  END_DATETIME  = now()           , </if>
			MOD_DATETIME  = now(),
		</set>
		<where>
			AND ORDER_ID = #{orderId}
		</where>
	</update>

	<delete id="deleteOrder" parameterType="long">
		/* 주문 삭제 */
		DELETE FROM
			ORDERS
		<where>
			AND ORDER_ID = #{orderId}
		</where>
	</delete>
</mapper>